---
layout:     post
title:      "Bangdream拆包及模型配置小记"
subtitle:   "Saya ore no yome"
date:       2019-01-08 20:44:00
author:     "kara"
header-img: "img/bangdream/saya.jpg"
tags:
    - 技术
    - live2d
    - blog
    - 安卓
---

> 西历2019年1月8日下午4点，本学期最后一门考试结束，宣告为历时数月的校内课程画下结点。

期末考试终于告一段落，这个学期花了太多时间摆弄电脑和手机。自我感觉成绩肯定没有上个学期好(~~从入学到现在一路下跌~~。回家肯定又会被母上大人各种BB。

痛定思痛,我最终下定决心，更多的看电脑。

如果这个站点有幸迎来台式终端的访问者的话，一定会注意到右下角的live2d角色被我更换成了bangdream里的山吹纱绫。此次多是繁琐的配置调试过程，并没有什么技术性的问题。姑且稍作记录。

---

## 拆包篇

既然是bangdream的拆包的话，当然需要一个各种版本的bangdream游戏安装包。这里我采用的是安卓版日服安装包。可以[点击这里](https://play.google.com/store/apps/details?id=jp.co.craftegg.band&hl=zh_CN)进行下载安装。这部分操作我都是在手机上完成的，也可以用模拟器进行安装，相对的与电脑进行资料交换也会更方便一些。

安装完之后进入游戏，进行第一次下载。国外的游戏与国内的有些不同，一般安装包非常轻量，大部分数据都是在游戏内进行下载。而中国特色的安装包则动辄几百兆甚至几个G。轻量化的安装包所带来的好处主要是升级更新操作更易实现，因为游戏主体框架已有，只需要对其中数据进行删改就行，而大型安装包因其资源全部整合到一个包中，更新一次通常要把新版安装包下载之后再整体安装。这之间浪费了相当多的时间和资源写入量。最近崩坏三从2.7版本开始采用了游戏内下载方式，也算是与国际接轨了。(~~中美结合，文体两开花~~。但在2.7版本之前九游服就已经采用了这种方式，米忽悠是在拿九游服进行测试吗？

说哪去了。继续拆包工作。第一次下载花的时间通常比较长，而且依版本不同，可能要进行多次。这里需将所有数据递归下载下来直至能进入游戏。下载完毕后，可以在 ***Android/data*** 目录下找到所下载的全部数据。这里我使用的是es文件管理器。想要现成的直接[戳这里](https://play.google.com/store/apps/details?id=com.estrongs.android.pop)。

可以在Android/data目录下翻到名叫 ***jp.co.craftegg.band*** 的目录，其中的 **./files/data** 就是我们所需要的目录了。可以直接把 data 目录压缩包发到电脑解压，然后用拆包软件进行拆包。拆包具体操作与[上篇文章](https://kara07.github.io/2018/12/08/live2d/)别无二致，可以参考其进行操作。

---

## 配置篇


最终将我们所得到的文件进行整理。一套分别是

1. 一个 .moc 模型文件
2. 一些 .mtn 动作文件
3. **与模型相对应的一个 texture_00.png 贴图文件。**

这里需要注意的是，bangdream与其他游戏不同，一个贴图文件对应一个模型文件。这说明了游戏中的每一套衣服都需要重新建模，每套衣服有唯一的模型，反之也成立。所以路径就不能像上一篇文章所说的设置，必须将贴图文件按照如下目录关系放置

```
.
├── model.json
├── saya_2019newyear
│   ├── motions
│   │   ├── ando01.mtn
│   │   ├── uwame01.mtn
│   │   ├── wink01.mtn
│   │   └── ...//other .mtn files
│   └── texture_00.png
└── saya_2019newyear.moc

```
这里我用了纱绫的新年和服模型来进行说明，最重要的就是将贴图文件 texture_00.png 放置于一个和模型文件同名的目录下，同时动作文件 motions 目录也放在此目录下。

最后和原先加载模型的方法一样在js脚本中调用loadlive2d函数就可以了。因为bangdream模型和贴图文件的特殊性，随机换装脚本可能会比较难写。只能每次切换界面重新加载模型，这会花费比较长的时间。本身用的github page服务在境内访问速度堪忧，这个功能近期还是不考虑了。以后要是有这些需求在考虑怎么实现吧。(kirari ☆~~



